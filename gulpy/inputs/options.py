KEYWORDS = [
    "PDFcut",
    "PDFkeep",
    "alamode",
    "allbonds",
    "allow_gt_1",
    "angle",
    "anneal",
    "atomic_stress",
    "average",
    "bond",
    "breathe",
    "broaden_dos",
    "bulk_noopt",
    "c6",
    "ceigen",
    "cellonly",
    "compare",
    "conjugate",
    "conp",
    "conserved",
    "conv",
    "coreinfo",
    "cosmic",
    "cosmo",
    "cost",
    "dcharge",
    "debug",
    "decimal_only",
    "defect",
    "delta_dipole",
    "derv2",
    "derv3",
    "dfp",
    "dipole",
    "distance",
    "dynamical_matrix",
    "eckart",
    "eem",
    "eembond",
    "efg",
    "eharmonic",
    "eigenvectors",
    "eregion",
    "fastfd",
    "fbfgs",
    "fit",
    "fix_molecule",
    "force_minimisation",
    "frame",
    "free_energy",
    "frequencies",
    "fsprop",
    "full",
    "gasteiger",
    "genetic",
    "ghostcell",
    "global",
    "gradient",
    "groupvelocity",
    "grueneisen",
    "hessian",
    "hexagonal",
    "hideshells",
    "hill",
    "include_imaginary",
    "intensity",
    "isotropic",
    "kcal",
    "kfull",
    "kjmol",
    "lbfgs",
    "libdump",
    "libff",
    "linmin",
    "lower_symmetry",
    "madelung",
    "makeEigenArrays",
    "marvinSE",
    "md",
    "meanke",
    "minimum_image",
    "molecule",
    "molmec",
    "molq",
    "montecarlo",
    "msd",
    "neb",
    "newda",
    "no4duplicates",
    "noaddshells",
    "noanisotropic_2b",
    "noautobond",
    "nobreathe",
    "nod2sym",
    "nod3",
    "nodensity_out",
    "nodneb",
    "nodpsym",
    "nodsymmetry",
    "noelectrostatics",
    "noenergy",
    "noexclude",
    "nofirst_point",
    "noflags",
    "nofrequency",
    "nokpoints",
    "noksymmetry",
    "nolist_md",
    "nomcediff",
    "nomodcoord",
    "nomolecularinternalke",
    "nononanal",
    "nopartial",
    "noqeem",
    "noquicksearch",
    "noreal",
    "norecip",
    "norepulsive_cutoff",
    "norxQ",
    "nosasinitevery",
    "nosderv",
    "noshellzero",
    "nosymmetry",
    "nowidth",
    "nowrap",
    "nozeropt",
    "num3",
    "numdiag",
    "numerical",
    "ocell",
    "oldintensity",
    "oldunits",
    "oldvarorder",
    "operators",
    "optimise",
    "optlower",
    "orthorhombic",
    "outcon",
    "pacha",
    "pdf",
    "phonon",
    "positive",
    "pot",
    "predict",
    "pregionforce",
    "preserve_Q",
    "property",
    "prt_eam",
    "prt_four",
    "prt_six",
    "prt_three",
    "prt_two",
    "pureQ",
    "qbond",
    "qeq",
    "qextrapolate",
    "qiterative",
    "qok",
    "qsas",
    "raman",
    "regi2a",
    "regi_before",
    "relax",
    "rephase",
    "restore",
    "rfo",
    "save",
    "shell",
    "shopt",
    "simplex",
    "simultaneous",
    "single",
    "site_energy",
    "sm",
    "sopt",
    "spatial",
    "spme",
    "static_first",
    "steepest",
    "storevectors",
    "strain",
    "stress_out",
    "thermalconductivity",
    "transition_state",
    "umorse",
    "unfix",
    "unit",
    "veck",
    "voigt",
    "zero_potential",
    "zsisa",
]

OPTIONS = [
    "3coulomb",
    "absdipolemoment",
    "absolute_coordinates",
    "accelerations",
    "accuracy",
    "ala_cutoff",
    "ala_disp",
    "ala_processors",
    "ala_shrink",
    "anisotropic_pressure",
    "ashift",
    "atomab",
    "aver",
    "axilrod-teller",
    "bacoscross",
    "bacross",
    "bagcross",
    "balcross",
    "baskes",
    "bbar",
    "bcoscross",
    "bcross",
    "becke_johnson_c6",
    "best",
    "blocksize",
    "boattractive",
    "bocharge",
    "bocnswitch",
    "bocntolerance",
    "bocoordination",
    "bondtype",
    "borepulsive",
    "bornq",
    "boselfenergy",
    "both",
    "botwobody",
    "box",
    "brenner",
    "bsm",
    "bspline",
    "buck4",
    "buckingham",
    "buffered_lj",
    "bulk_modulus",
    "cartesian",
    "catomic_stress",
    "caver",
    "cell",
    "centre",
    "cfaver",
    "cfm_fermi",
    "cfm_gaussian",
    "cfm_harmonic",
    "cfm_power",
    "charge",
    "chemshell_mode",
    "cmm",
    "configurations",
    "connect",
    "constrain",
    "contents",
    "coordno",
    "cosh-spring",
    "cosmoframe",
    "cosmoshape",
    "coulomb_subtract",
    "covalent",
    "covexp",
    "crossover",
    "cstrain",
    "current_time",
    "cutd",
    "cutmany",
    "cutp",
    "cuts",
    "cv",
    "cvec",
    "cwolf",
    "damped_dispersion",
    "default_weight",
    "deflist",
    "delay_field",
    "delay_force",
    "delf",
    "delta",
    "dhkl",
    "discrete",
    "dispersion",
    "ditto",
    "dmaximum",
    "dminimum",
    "dump",
    "eam_alloy",
    "eam_density",
    "eam_functional",
    "eam_potential_shift",
    "edip_accuracy",
    "edip_coordination",
    "edip_threebody",
    "edip_twobody",
    "edip_zmax",
    "einstein",
    "elastic",
    "electronegativity",
    "element",
    "end_field",
    "end_force",
    "energy",
    "ensemble",
    "entropy",
    "epsilon",
    "sigma",
    "equatorial",
    "equilibration",
    "erferfc",
    "erfpot",
    "erongi",
    "ewaldrealradius",
    "exp2",
    "exponential_three_body",
    "exppowers",
    "external_force",
    "external_potential",
    "extracutoff",
    "factor",
    "fangle",
    "fbond",
    "fc_supercell",
    "fcartesian",
    "fcell",
    "fenergy",
    "fermi-dirac",
    "ffractional",
    "field",
    "finite",
    "fix_atom",
    "forceconstant",
    "fractional",
    "frequency",
    "frqtol",
    "ftol",
    "fvectors",
    "g3coulomb",
    "gamma_angular_steps",
    "gamma_direction_of_approach",
    "gastdamping",
    "gastiter",
    "gastparam",
    "gasttol",
    "gcmcexistingmolecules",
    "gcmcmolecule",
    "gcmcspecies",
    "gcoulomb",
    "gdcrit",
    "general",
    "genetic",
    "gexp",
    "ghost_supercell",
    "gmax",
    "gradients",
    "grid",
    "grimme_c6",
    "gtol",
    "harmonic",
    "hfdlc",
    "hfrefractive_index",
    "high-fq",
    "dielectric",
    "hydrogen-bond",
    "igauss",
    "ignore",
    "impurity",
    "include",
    "index_k",
    "initial_coordinates",
    "intconserved",
    "integrator",
    "inter",
    "interstitial",
    "intra",
    "inversion",
    "ionic",
    "iterations",
    "j2",
    "j3",
    "keyword",
    "kim_model",
    "kpoints",
    "lbfgs_order",
    "lennard",
    "library",
    "lin3",
    "line",
    "ljbuffered",
    "lorentzian_tolerance",
    "lowest_mode",
    "manybody",
    "marvin",
    "mass",
    "maths",
    "matrix_format",
    "maxcyc",
    "maximise",
    "maximum",
    "mcchemicalpotential",
    "mccreate",
    "mcdestroy",
    "mclowest",
    "mcmaxdisplacement",
    "mcmaxrotation",
    "mcmaxstrain",
    "mcmeans",
    "mcmove",
    "mcoutfreq",
    "mcrotate",
    "mcsample",
    "mcstep",
    "mcstrain",
    "mcswap",
    "mctrial",
    "mcvolume",
    "mdarchive",
    "mdmaxtemp",
    "mdmaxvolume",
    "meam_density",
    "meam_functional",
    "meam_rhotype",
    "meam_screening",
    "mei-davenport",
    "mincell",
    "minimum",
    "mm3angle",
    "mm3buck",
    "mm3stretch",
    "mode",
    "mode2a",
    "momentum_correct",
    "monopoleq",
    "morse",
    "move_2a_to_1",
    "murrell-mottram",
    "mutation",
    "name",
    "nebiterations",
    "nebrandom",
    "nebreplica",
    "nebspring",
    "nebtangent",
    "nebtolerance",
    "nmr",
    "nobond",
    "observables",
    "odirection",
    "omega",
    "omega_af",
    "omega_damping",
    "origin",
    "outofplane",
    "output",
    "p_flexible",
    "p_isotropic",
    "parallel",
    "pcell",
    "pdf",
    "pfinite",
    "pfractional",
    "piezoelectric",
    "plane_lj",
    "plumed_input",
    "plumed_log",
    "pointsperatom",
    "poisson_ratio",
    "polarisability",
    "polynomial",
    "potential",
    "potential_interpolation",
    "potgrid",
    "potsites",
    "pressure",
    "print",
    "production",
    "project_dos",
    "pvector",
    "qelectronegativity",
    "qeqiter",
    "qeqradius",
    "qeqtol",
    "qerfc",
    "qgrid",
    "qincrement",
    "qiterations",
    "qmmm",
    "qonsas",
    "qoverr2",
    "qreaxff",
    "qsolver",
    "qtaper",
    "qwolf",
    "radial_force",
    "random",
    "rangeforsmooth",
    "rbins",
    "rcartesian",
    "rcell",
    "rcspatial",
    "rdirection",
    "reaction",
    "reaxff0_bond",
    "reaxff0_lonepair",
    "reaxff0_over",
    "reaxff0_penalty",
    "reaxff0_torsion",
    "reaxff0_valence",
    "reaxff0_vdw",
    "reaxff1_angle",
    "reaxff1_include_under",
    "reaxff1_lonepair",
    "reaxff1_morse",
    "reaxff1_over",
    "reaxff1_radii",
    "reaxff1_under",
    "reaxff1_valence",
    "reaxff2_bo",
    "reaxff2_bond",
    "reaxff2_morse",
    "reaxff2_over",
    "reaxff2_pen",
    "reaxff3_angle",
    "reaxff3_conjugation",
    "reaxff3_hbond",
    "reaxff3_pen",
    "reaxff4_torsion",
    "reaxff_chi",
    "reaxff_gamma",
    "reaxff_mu",
    "reaxff_q0",
    "reaxff_qshell",
    "reaxff_r12",
    "reaxffsmooth",
    "reaxfftol",
    "region_1",
    "reldef",
    "reperfc",
    "resetvectors",
    "rfo_eig",
    "rfo_grad",
    "rfractional",
    "rmax",
    "rspeed",
    "rtol",
    "ryckaert",
    "rydberg",
    "sample",
    "sasexclude",
    "sasparticles",
    "sbulkenergy",
    "scale",
    "scan_cell",
    "scell",
    "scmaxsearch",
    "sdlc",
    "seed",
    "segmentsperatom",
    "sfinite",
    "sfractional",
    "shear_force",
    "shear_modulus",
    "shellmass",
    "shift",
    "shrink",
    "siginc",
    "size",
    "slater",
    "slower",
    "smelectronegativity",
    "solventepsilon",
    "solventradius",
    "solventrmax",
    "spacegroup",
    "species",
    "spin",
    "spline",
    "split",
    "spring",
    "sqomega",
    "squaredharmonic",
    "srefractive_index",
    "sregion2",
    "srglue",
    "sshift",
    "start",
    "static",
    "dielectric",
    "stepmx",
    "stop",
    "strain_derivative",
    "stress",
    "supercell",
    "svectors",
    "sw2",
    "sw2jb",
    "sw3",
    "sw3jb",
    "switch_minimiser",
    "switch_stepmx",
    "symbol",
    "symmetry_cell",
    "symmetry_number",
    "symmetry_operator",
    "synciterations",
    "syncsteps",
    "synctolerance",
    "tau_barostat",
    "tau_thermostat",
    "td_external_force",
    "td_field",
    "temperature",
    "terse",
    "tether",
    "three-body",
    "threshold",
    "time",
    "timestep",
    "title",
    "torangle",
    "torcosangle",
    "torexp",
    "torharm",
    "torsion",
    "tortaper",
    "totalenergy",
    "tournament",
    "tpxo",
    "translate",
    "tscale",
    "tsuneyuki",
    "ttol",
    "twist",
    "uff1",
    "uff3",
    "uff4",
    "uff_bondorder",
    "uffoop",
    "unfreeze",
    "unique",
    "units",
    "update",
    "urey-bradley",
    "vacancy",
    "variables",
    "vbo_twobody",
    "vdw",
    "vectors",
    "velocities",
    "volume",
    "weight",
    "wmax",
    "wmin",
    "write",
    "xangleangle",
    "xcosangleangle",
    "xoutofplane",
    "xtol",
    "youngs_modulus",
    "zbl",
]

HEADERS = [
    "3coulomb",
    "absolute_coordinates",
    "accelerations",
    "ashift",
    "atomab",
    "aver",
    "axilrod-teller",
    "bacoscross",
    "bacross",
    "bagcross",
    "balcross",
    "baskes",
    "bcoscross",
    "bcross",
    "becke_johnson_c6",
    "boattractive",
    "bocharge",
    "bocoordination",
    "borepulsive",
    "bornq",
    "boselfenergy",
    "botwobody",
    "bsm",
    "buck4",
    "buckingham",
    "buffered_lj",
    "cartesian",
    "catomic_stress",
    "caver",
    "cfm_fermi",
    "cfm_gaussian",
    "cfm_harmonic",
    "cfm_power",
    "charge",
    "constrain",
    "contents",
    "coordno",
    "cosh-spring",
    "cosmoframe",
    "coulomb_subtract",
    "covexp",
    "damped_dispersion",
    "deflist",
    "discrete",
    "dispersion",
    "eam_alloy",
    "eam_density",
    "eam_functional",
    "eam_potential_shift",
    "edip_coordination",
    "edip_threebody",
    "edip_twobody",
    "einstein",
    "electronegativity",
    "element",
    "epsilon",
    "sigma",
    "equatorial",
    "erferfc",
    "erfpot",
    "exp2",
    "exponential_three_body",
    "exppowers",
    "external_force",
    "external_potential",
    "fangle",
    "fbond",
    "fcartesian",
    "fcell",
    "fermi-dirac",
    "ffractional",
    "forceconstant",
    "fractional",
    "fvectors",
    "g3coulomb",
    "gcmcexistingmolecules",
    "gcmcmolecule",
    "gcmcspecies",
    "gcoulomb",
    "general",
    "genetic",
    "gradients",
    "grimme_c6",
    "harmonic",
    "dielectric",
    "hydrogen-bond",
    "igauss",
    "initial_coordinates",
    "inversion",
    "kim_model",
    "kpoints",
    "lennard",
    "lin3",
    "ljbuffered",
    "manybody",
    "meam_density",
    "meam_functional",
    "meam_rhotype",
    "meam_screening",
    "mei-davenport",
    "mm3angle",
    "mm3buck",
    "mm3stretch",
    "mode",
    "monopoleq",
    "morse",
    "murrell-mottram",
    "outofplane",
    "p_flexible",
    "pcell",
    "pfractional",
    "piezoelectric",
    "plane_lj",
    "poisson_ratio",
    "polarisability",
    "polynomial",
    "potential",
    "potsites",
    "project_dos",
    "pvector",
    "qelectronegativity",
    "qincrement",
    "qoverr2",
    "qreaxff",
    "qtaper",
    "rcartesian",
    "rcell",
    "rcspatial",
    "reaxff1_angle",
    "reaxff1_include_under",
    "reaxff1_lonepair",
    "reaxff1_morse",
    "reaxff1_over",
    "reaxff1_radii",
    "reaxff1_under",
    "reaxff1_valence",
    "reaxff2_bo",
    "reaxff2_bond",
    "reaxff2_morse",
    "reaxff2_over",
    "reaxff2_pen",
    "reaxff3_angle",
    "reaxff3_conjugation",
    "reaxff3_hbond",
    "reaxff3_pen",
    "reaxff4_torsion",
    "reaxff_chi",
    "reaxff_gamma",
    "reaxff_mu",
    "reaxff_q0",
    "reaxff_qshell",
    "reaxff_r12",
    "reaxffsmooth",
    "region_1",
    "reldef",
    "reperfc",
    "rfo_eig",
    "rfo_grad",
    "rfractional",
    "ryckaert",
    "rydberg",
    "scan_cell",
    "scell",
    "sdlc",
    "sfractional",
    "shear_force",
    "slater",
    "smelectronegativity",
    "species",
    "spin",
    "spline",
    "split",
    "spring",
    "squaredharmonic",
    "srglue",
    "static dielectric",
    "strain_derivative",
    "stress",
    "svectors",
    "sw2",
    "sw2jb",
    "sw3",
    "sw3jb",
    "symmetry_operator",
    "td_external_force",
    "three-body",
    "title",
    "torangle",
    "torcosangle",
    "torexp",
    "torharm",
    "torsion",
    "tortaper",
    "tsuneyuki",
    "uff1",
    "uff3",
    "uff4",
    "uffoop",
    "unfreeze",
    "urey-bradley",
    "vbo_twobody",
    "vectors",
    "velocities",
    "weight",
    "xangleangle",
    "xcosangleangle",
    "xoutofplane",
    "youngs_modulus",
    "zbl",
]


def is_in_keywords(text, kwds):
    return text in kwds or any([text[:4] == kw[:4] for kw in kwds])


def is_keyword(text):
    """Returns True if the text is a GULP reserved keyword"""
    return is_in_keywords(text.strip(), KEYWORDS)


def is_option(text):
    """Returns True if the text is a GULP reserved option"""
    return is_in_keywords(text.strip(), OPTIONS)


def is_header(text):
    """Returns True if the text is a GULP header
        i.e. if we should expect more information
        such as a table to come after it.
    """
    return is_in_keywords(text.strip(), HEADERS)


def is_reserved(text):
    """Returns True if the text is a GULP reserved word"""
    return is_option(text) or is_keyword(text)


def is_comment(text):
    return text.strip().startswith("#")
